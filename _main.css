



body{
  margin:0;
  padding:20px;
  background:radial-gradient(circle at top,#555 0%,#1b1b1b 70%);
  color:var(--paper);
  font-family:'Oswald',sans-serif;
}

/* HEADER */
.header{
  display:flex;
  align-items:stretch;
  width:100%;
  gap:12px;
  margin-bottom:18px;
}
h1{
  flex:1;
  margin:0;
  font-family:'Special Elite',monospace;
  letter-spacing:2px;
  text-transform:uppercase;
  background:linear-gradient(to right,var(--olive),var(--steel));
  padding:14px 20px;
  border:2px solid var(--khaki);
  display:flex;
  align-items:center;
}

.xp-panel{
  width:260px;
  padding:12px;
  border:2px solid var(--khaki);
  background:linear-gradient(145deg,#2b2b2b,#1a1a1a);
  display:flex;
  flex-direction:column;
  justify-content:center;
  box-sizing:border-box;
}
.xp-value{
  font-size:26px;
  text-align:center;
  margin-bottom:8px;
}
.xp-buttons{
  display:flex;
  gap:10px;
  justify-content:center;
}

button{
  background:linear-gradient(180deg,var(--olive),#2e3313);
  color:var(--paper);
  border:2px solid var(--khaki);
  padding:10px 18px;
  font-size:14px;
  text-transform:uppercase;
  cursor:pointer;
}
.danger{ background:linear-gradient(180deg,var(--danger),#4b1111); }

/* CONTROLS */
.controls{
  display:flex;
  gap:24px;
  align-items:stretch;
  background:linear-gradient(145deg,#3a3f2b,#262a1d);
  border:2px solid var(--olive);
  padding:15px;
  margin-bottom:18px;
  box-sizing:border-box;
}
.left-controls{
  display:flex;
  flex-direction:column;
  gap:12px;
}

/* Commander tile */
.commander-tile{
  width:150px;
  height:320px;
  border:4px solid var(--khaki);
  background:rgba(0,0,0,0.4);
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  font-size:16px;
  cursor:pointer;
  padding:10px;
  box-sizing:border-box;
  position:relative;
  overflow:hidden;
}
.commander-tile .plus{
  position:absolute;
  top:0px;
  //left:12px;
  font-size:300px;
  line-height:1;
  opacity:0.3;
  pointer-events:none;
}
.commander-tile .label{
  padding:8px;
  line-height:1.1;
  user-select:none;
}
.commander-tile img{
  width:100%;
  height:100%;
  object-fit:contain;
  display:block;
}

/* Emphasis until commander selected */
.commander-emphasis{
  outline:2px dashed rgba(196,154,44,0.7);
  outline-offset:8px;
  box-shadow:0 0 18px rgba(196,154,44,0.35);
  animation:commanderPulse 1.2s ease-in-out infinite alternate;
}
@keyframes commanderPulse{
  from{ transform:translateY(0); box-shadow:0 0 12px rgba(196,154,44,0.15); }
  to{ transform:translateY(-2px); box-shadow:0 0 52px rgba(196,154,44,0.45); }
}

/* Buildable Units */
.buildable{
  flex:1;
  display:flex;
  flex-direction:column;
  min-height:0;
  transition:opacity 180ms ease;
}
.buildable.buildable-dim{ opacity:0.25; }

h3{
  flex:0 0 10%;
  margin:0 0 8px;
  /*display:flex;*/
  align-items:center;
  text-align:center;
}
.build-slots{
  flex:1 1 90%;
  min-height:0;
  display:flex;
  gap:12px;
}
.build-slot{
  flex:1;
  height:100%;
  border:3px solid var(--khaki);
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  background:rgba(0,0,0,0.35);
  font-size:14px;
  text-transform:uppercase;
  padding:10px;
  box-sizing:border-box;
  overflow:hidden;
  user-select:none;
  cursor:default;
}
.build-slot-placeholder{
  color:rgba(230,226,211,0.55);
  font-style:italic;
}

/* ================== UNIT SWAP MODAL ================== */
.unit-option-card{
  cursor:pointer;
}

.unit-option-card img{
  max-width:100%;
  height:auto;
  max-height:440px;
  object-fit:contain;
  border:4px solid var(--khaki);
  background:rgba(0,0,0,0.4);
  box-sizing:border-box;
  padding:8px;
  display:block;
  margin:0 auto;
}

.unit-subtitle{
  margin-top:8px;
  font-size:12px;
  letter-spacing:1px;
  text-transform:uppercase;
  opacity:0.85;
  text-align:center;
}

@media (pointer: coarse){
  #unitSwapModal .modal-grid{
	grid-template-columns:repeat(2, 1fr);
  }
  /* Use carousel on mobile, keep grids for desktop */
  #unitSwapGrid{ display:none; }
  #unitReplaceGrid{ display:none; } /* we’ll show carousel instead */
  #unitSwapModal .modal-body{
	overflow:hidden;
	min-height:0;
  }

}

/* ================== UNIT SWAP MOBILE CAROUSEL ================== */
.us-carousel{
  width:100%;
  overflow:hidden;
  padding:6px 0 12px;
  box-sizing:border-box;
}

.us-track{
  display:flex;
  align-items:center;
  box-sizing:border-box;
  padding: 0 10vw;  /* peek window */
  gap: 12px;
  will-change:transform;
  touch-action:pan-y;
}

.us-slide{
  flex: 0 0 72vw;
  padding: 6px 0;
  display:flex;
  justify-content:center;
  align-items:center;
  box-sizing:border-box;
}

.us-card{
  width:100%;
  aspect-ratio: 150 / 320;
  border:4px solid var(--khaki);
  background:rgba(0,0,0,0.35);
  overflow:hidden;
  position:relative;
  transform:scale(0.88);
  opacity:0.45;
  filter:grayscale(0.25);
  transition:transform 260ms ease, opacity 260ms ease, filter 260ms ease;
  display:flex;
  align-items:center;
  justify-content:center;
}

.us-card img{
  width:100%;
  height:100%;
  object-fit:contain;
  display:block;
  pointer-events:none;
  user-select:none;
  -webkit-user-drag:none;
}

.us-card.is-active{
  transform:scale(1);
  opacity:1;
  filter:none;
  box-shadow:0 0 18px rgba(196,154,44,0.22);
}

	/* Upgrades */
	.upgrades-hidden{ display:none; }

	h2{ margin:8px 0 10px;
		text-align:center;

	}
	
	/* ================== RARITY BORDER THICKNESS ================== */
/* Modal cards: border is on the IMG */
.upgrade-card.elite img{ border-width:6px; }
.upgrade-card.legendary img{ border-width:8px; }

/* Carousel tiles: border is on the TILE container */
.upgrade-tile.elite{
  border-width:6px;
  border-color:var(--elite);
}
.upgrade-tile.legendary{
  border-width:8px;
  border-color:var(--legendary);
  box-shadow:0 0 16px rgba(196,154,44,0.25);
}

/* Optional: make common/veteran match your existing khaki framing */
.upgrade-tile.common,
.upgrade-tile.veteran{
  border-color:var(--khaki);
}

/* ================== LEGENDARY REVEAL EFFECT ================== */
/* Apply class .legendary-reveal to a legendary card to animate a veil lifting */
.upgrade-card.legendary.legendary-reveal{
  overflow:hidden; /* ensure overlay clips */
}

.upgrade-card.legendary.legendary-reveal::before{
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(
	180deg,
	rgba(0,0,0,0.92) 0%,
	rgba(0,0,0,0.75) 55%,
	rgba(0,0,0,0.0) 100%
  );
  transform:translateY(0);
  animation:legendaryReveal 1.8s ease-out forwards;
  pointer-events:none;
}

.upgrade-card.legendary.legendary-reveal::after{
  content:'';
  position:absolute;
  inset:-20%;
  background:radial-gradient(circle, rgba(196,154,44,0.22) 0%, rgba(196,154,44,0.0) 60%);
  opacity:0;
  animation:legendaryGlimmer 1.8s ease-out forwards;
  pointer-events:none;
}

@keyframes legendaryReveal{
  0%{ transform:translateY(0); }
  100%{ transform:translateY(-110%); }
}

@keyframes legendaryGlimmer{
  0%{ opacity:0; transform:scale(0.95); }
  35%{ opacity:1; }
  100%{ opacity:0; transform:scale(1.05); }
}

/* ================== ASPECT-AWARE IMAGES (SAFE) ================== */
.aspect-aware{
  display:block;
  width:100%;
  height:100%;
  object-fit:contain;
}

/* Portrait: don't force height to 100% (that makes it huge).
   Instead, give it a little more side padding feel by limiting height a bit. */
.aspect-aware.portrait{
  max-width:100%;
}

/* Landscape: typically fine as-is, but you can also cap slightly if desired */
.aspect-aware.landscape{
  max-height:100%;
  max-width:100%;
}

/* ================== HOVER POPUP ================== */

.hover-popup{
  position:fixed;
  display:none;
  z-index:2000;
  pointer-events:none;
  background:rgba(12,12,12,0.92);
  border:2px solid var(--khaki);
  box-shadow:0 0 18px rgba(0,0,0,0.65);
  padding:10px;
  max-width:520px;
}

.hover-popup img{
  width:100%;
  height:auto;
  max-height:70vh;      /* safety clamp so it never gets absurdly tall */
  object-fit:contain;
  display:block;
  background:#111;
  border:2px solid var(--olive);
  padding:10px;
  box-sizing:border-box;
}

.hover-popup .hover-title{
  margin-bottom:10px;
  font-size:16px;
  letter-spacing:1px;
  text-transform:uppercase;
  opacity:0.9;
  text-align:center;
}


.carousel{
  display:flex;
  gap:12px;
  overflow-x:auto;
  padding:10px;
  align-items:center;
  border:2px solid rgba(182,168,117,0.25);
  background:rgba(0,0,0,0.18);
  box-sizing:border-box;
}

.upgrade-tile{
  width:150px;
  height:320px;
  border:4px solid var(--khaki);
  background:rgba(0,0,0,0.4);
  padding:6px;
  box-sizing:border-box;
  display:flex;
  align-items:center;
  justify-content:center;
  flex:0 0 auto;
  overflow:hidden;
}
.upgrade-tile img{
  width:100%;
  height:100%;
  object-fit:contain;
  display:block;
  background:#111;
}

.add-upgrade{
  width:150px;
  height:320px;
  border:4px solid var(--khaki);
  background:rgba(0,0,0,0.4);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:64px;
  cursor:pointer;
  box-sizing:border-box;
  flex:0 0 auto;
  user-select:none;
}

/* Modal shared */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.85);
  justify-content:center;
  align-items:center;
  z-index:1000;
}

.modal-content{
  background:#1e1e1e;
  border:3px solid var(--olive);
  padding:0;
  width:900px;
  max-height:80vh;
  position:relative;
  display:flex;
  flex-direction:column;
}

.modal-header{
  flex:0 0 auto;
  padding:14px 16px;
  border-bottom:2px solid rgba(182,168,117,0.25);
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  position:sticky;
  top:0;
  background:#1e1e1e;
  z-index:2;
}

.modal-body{
  flex:1 1 auto;
  padding:10px;
  overflow-y:clip;
}

.modal-close{
  cursor:pointer;
  font-size:34px;
  color:var(--danger);
  user-select:none;
  line-height:1;
}

.modal-grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:16px;
  margin-top:12px;
}

.upgrade-card{
  cursor:pointer;
  padding:10px;
  border:2px solid transparent;
  background:rgba(0,0,0,0.25);
  position:relative;
  box-sizing:border-box;
}



.upgrade-card img{
  max-width:100%;
  height:auto;
  max-height:440px;
  object-fit:contain;
  border:4px solid;
  background:rgba(0,0,0,0.4);
  box-sizing:border-box;
  padding:8px;
  display:block;
  margin:0 auto;
}
.upgrade-card.common img{ border-color:var(--common); }
.upgrade-card.veteran img{ border-color:var(--veteran); }
.upgrade-card.elite img{ border-color:var(--elite); }
.upgrade-card.legendary img{ border-color:var(--legendary); }

.rarity-label{
  position:absolute;
  bottom:8px;
  right:8px;
  padding:2px 6px;
  font-size:12px;
  background:rgba(0,0,0,0.7);
  border:1px solid var(--khaki);
  text-transform:uppercase;
}

.locked{
  opacity:0.35;
  filter:grayscale(1);
  cursor:not-allowed;
}
.locked::after{
  content:'INSUFFICIENT XP';
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:18px;
  font-weight:bold;
  background:rgba(139,43,43,0.6);
  border:2px solid var(--danger);
  color:#fff;
  text-align:center;
}

.xp-denied{ animation:shake .35s; }
@keyframes shake{
  0%{transform:translateX(0)}
  25%{transform:translateX(-6px)}
  50%{transform:translateX(6px)}
  75%{transform:translateX(-6px)}
  100%{transform:translateX(0)}
}

.reroll-danger{ animation:pulse 0.6s infinite alternate; }
@keyframes pulse{ from{ box-shadow:none; } to{ box-shadow:0 0 12px var(--danger); } }

.sheet{
  position:fixed;
  inset:0;
  display:none;
  background:rgba(0,0,0,0.75);
  z-index:3000;
}

.sheet[aria-hidden="false"]{ display:block; }

.sheet-inner{
  position:absolute;
  left:0; right:0; bottom:0;
  background:#141414;
  border-top:3px solid var(--olive);
  border-radius:18px 18px 0 0;
  max-height:85vh;
  display:flex;
  flex-direction:column;
}

.sheet-header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:12px 14px;
  border-bottom:1px solid rgba(182,168,117,0.25);
}

.sheet-title{
  font-size:16px;
  letter-spacing:1px;
  text-transform:uppercase;
}

.sheet-close{
  width:44px;
  height:44px;
  font-size:30px;
  line-height:1;
  background:transparent;
  border:2px solid var(--khaki);
  color:var(--paper);
  border-radius:10px;
}

.sheet-body{
  padding:12px 14px 18px;
  overflow:auto;
}

.sheet-body img{
  width:100%;
  height:auto;
  max-height:70vh;
  object-fit:contain;
  display:block;
  background:#0f0f0f;
  border:2px solid var(--olive);
  padding:10px;
  box-sizing:border-box;
}

	
	.callin-badge{
	  position:absolute;
	  top:8px;
	  right:8px;
	  font-size:11px;
	  padding:2px 6px;
	  border:1px solid var(--khaki);
	  background:rgba(0,0,0,0.65);
	  text-transform:uppercase;
	  letter-spacing:1px;
	}
	
	/* Only show on touch devices */
	@media (pointer: fine){
	  .tap-hint{ display:none; }
	}
	
	
	@media (pointer: coarse){
	  .tap-hint{
		animation:hintPulse 1.2s ease-out 1;
		background:rgba(0,0,0,0.75);
		cursor:pointer;
		border:1px solid var(--khaki);
		color:var(--paper);
		z-index:2;
		pointer-events:auto; /* allow tapping badge */
		position:absolute;
		  top:10px;
		  right:10px;
		  left:auto;            /* ensure it’s NOT top-left */
		  z-index:5;

		  /* 50% bigger */
		  font-size:18px;       /* was ~12px */
		  padding:6px 12px;     /* was ~4px 8px */
		  border-width:2px;     /* if you had a 1px border */
		  border-radius:6px;

		  /* keep existing look if you already styled it */
		  text-transform:uppercase;
		  font-weight:700;
		  letter-spacing:0.5px;
	  }
	}
	
		/* Ensure parent is positioned so absolute works */
	.upgrade-card,
	.upgrade-tile,
	.picker-card{
	  position:relative;
	}
	
	@keyframes hintPulse{
	  0%{ transform:scale(0.9); opacity:0; }
	  40%{ transform:scale(1.1); opacity:1; }
	  100%{ transform:scale(1); }
	}
	
	
/* ================== COMMANDER MOBILE CAROUSEL ================== */
.cmd-carousel{
  display:none;
  width:100%;
  overflow:hidden;
  padding:4px 0 4px;
  box-sizing:border-box;
}

.cmd-track{
  display:flex;
  align-items:center;
  will-change:transform;
  touch-action:pan-y; /* allow vertical scroll; we handle horizontal swipe */
}


.cmd-card{
  width:min(66vw, 360px);
  aspect-ratio: 150 / 320; /* match your tile proportions */
  border:4px solid var(--khaki);
  background:rgba(0,0,0,0.35);
  overflow:hidden;
  position:relative;
  transform:scale(0.88);
  opacity:0.45;
  filter:grayscale(0.25);
  transition:transform 260ms ease, opacity 260ms ease, filter 260ms ease;
  display:flex;
  align-items:center;
  justify-content:center;
}

.cmd-card img{
  width:100%;
  height:100%;
  object-fit:contain;
  display:block;
}

/* Focused (center) */
.cmd-card.is-active{
  transform:scale(1);
  opacity:1;
  filter:none;
  box-shadow:0 0 18px rgba(196,154,44,0.22);
}

/* Slightly visible peek of neighbors */
@media (pointer: coarse){
  .cmd-carousel{ display:block; }
  #commanderGrid{ display:none; } /* hide grid on touch devices */
}

/* Smooth snapping feel */
.cmd-track.is-animating{
  transition:transform 280ms ease;
}

.image-viewer-body{
  display:flex;
  justify-content:center;
  align-items:center;
}

.image-viewer-wrap{
  position:relative;
  max-width:100%;
  max-height:70vh;
}

#imageViewerImg{
  display:block;
  max-width:100%;
  max-height:70vh;
  object-fit:contain;
}

#imageViewerCallInBadge{
  position:absolute;
  top:10px;
  left:10px;
  z-index:3;
}

.carousel-shell{
  position:relative;
}

.carousel-arrow{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  font-size:42px;
  line-height:1;
  padding:10px;
  color:rgba(230,226,211,0.85);
  background:rgba(0,0,0,0.45);
  border:2px solid var(--khaki);
  border-radius:50%;
  cursor:pointer;
  user-select:none;
  z-index:5;
  transition:opacity 200ms ease, transform 200ms ease;
}

.carousel-arrow.left{
  left:-22px;
}

.carousel-arrow.right{
  right:-22px;
}

.carousel-arrow.disabled{
  opacity:0;
  pointer-events:none;
  transform:translateY(-50%) scale(0.85);
}

/* Mobile: slightly larger tap targets */
@media (pointer: coarse){
  .carousel-arrow{
    font-size:52px;
    padding:14px;
  }
}

